<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="model2.board">
<select id="allCnt" resultType="int">
   SELECT COUNT(NUM) CNT FROM BOARD
</select>
 <select id="getArticles" parameterType="hashmap" 
                 resultType="bdto">
    SELECT A.*                                                          
   FROM (SELECT ROWNUM RR, RBOARD.*                               
           FROM  (SELECT NUM, WRITER, SUBJECT, EMAIL, CONTENT,    
                         PASSWD, REG_DATE, READCNT, REF, RE_STEP, 
                         RE_LEVEL, ATTACHNM                       
                   FROM BOARD                                     
                   ORDER BY REF DESC, RE_STEP ASC) RBOARD) A
    <if test="start!=null">
    WHERE A.RR BETWEEN #{start} AND #{end}                                    
    </if>
    
    <if test="num!=null">
    where NUM=#{num}
    </if>                 
 </select>
 
 <select id="newNum" resultType="int">
 	select nvl(max(num),0)+1 num from board
 
 </select>
 
 <insert id="boardWrite" parameterType="bdto">
 	insert into board(NUM, WRITER, SUBJECT, EMAIL, CONTENT, PASSWD, 
 		REG_DATE, READCNT, REF, RE_STEP, RE_LEVEL, ATTACHNM )
 			values(#{num},#{writer},#{subject},#{email},#{content},#{passwd},
 				sysdate,0,#{ref},#{re_step},#{re_level},#{attachNm})
 </insert>
 
</mapper>